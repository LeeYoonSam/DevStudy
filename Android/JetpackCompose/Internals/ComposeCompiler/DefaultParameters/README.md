# 디폴트 매개변수 (Default Parameters)

> 컴파일 타임에는 각 `Composable` 함수에 `$default`라는 또 다른 **메타데이터**가 매개변수로 추가됩니다.

## 개요

**Kotlin의 디폴트 매개변수 기능**은 `Composable` 함수의 매개변수에는 사용할 수 없습니다. 그 이유는 `Composable` 함수는 매개변수에 대한 **기본 표현식을 함수의 범위**(생성된 그룹) 내에서 실행해야 하기 때문입니다. 

Compose는 이러한 디폴트 매개변수 문제를 해결하기 위한 **대안**을 제공합니다.

## 동작 원리

Compose는 `Composable` 함수에서 각 매개변수의 인덱스를 **비트마스킹 기법**으로 매핑하는 `$default` 매개변수를 통하여 디폴트 값을 가진 매개변수를 나타냅니다. 

### 주요 특징

- **비트마스킹**: `$changed` 매개변수와 동일한 방식으로 수행됩니다
- **매개변수 매핑**: 디폴트 값을 가지는 n개의 입력 매개변수마다 `$default` 매개변수를 하나씩 가집니다
- **값 결정**: 호출자가 값을 제공했는지 확인하여 디폴트 값 사용 여부를 결정합니다

## 컴파일러 변환 예제

아래 예시는 `$default` 비트마스크 매개변수가 주입되기 **전과 후**의 `Composable` 함수 형태를 보여줍니다:

```kotlin
// Before compiler (sources)
@Composable fun A(x: Int = 0) {
  f(x)
}

// After compiler
@Composable fun A(x: Int, $changed: Int, $default: Int) {
  // ...
  val x = if ($default and 0b1 != 0) 0 else x
  f(x)
  // ...
}
```

## 비트 연산 처리

`$changed` 매개변수의 사례와 마찬가지로 **비트의 조작**이 수행됩니다. 

### 처리 과정

1. **비트마스킹 확인**: `$default` 매개변수를 사용한 비트마스킹으로 디폴트 값 필요 여부 확인
2. **값 설정**: 조건에 따라 디폴트 값(0) 또는 원래 값 유지
3. **최종 결정**: 호출자가 제공한 값과 디폴트 값 중 적절한 값 선택

## 요약

- **디폴트 매개변수 제한**: Kotlin의 기본 디폴트 매개변수 기능은 `Composable` 함수에서 직접 사용 불가
- **`$default` 매개변수**: 비트마스킹 기법을 통해 디폴트 값 처리를 위한 메타데이터 제공
- **컴파일러 변환**: 컴파일 타임에 `$default` 매개변수가 자동으로 추가되어 런타임에 적절한 값 선택
- **비트 연산 활용**: `$changed`와 유사한 방식으로 효율적인 비트 조작을 통한 매개변수 처리