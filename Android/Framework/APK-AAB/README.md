# APK 파일과 AAB 파일의 차이점은 무엇인가요?

안드로이드 애플리케이션은 주로 **APK(Android Package)** 와 [**AAB(Android App Bundle)**](https://developer.android.com/guide/app-bundle) 라는 두 가지 기본 형식을 사용하여 배포되고 설치됩니다. 두 형식 모두 안드로이드 앱을 전달하는 역할을 하지만, 목적, 구조, 그리고 설치 중 처리 방식에서 상당한 차이가 있습니다.

### APK (Android Package, 안드로이드 패키지)

APK 파일은 안드로이드 애플리케이션을 배포하고 설치하기 위한 **전통적인 형식**입니다. 이는 앱이 기기에서 작동하는 데 필요한 모든 리소스, 코드, 메타데이터를 포함하는 **완전하고 바로 설치 가능한 패키지**입니다.

APK 파일은 **자체 포함(self-contained)** 되어 있어, 모든 기기 구성(예: 화면 밀도, CPU 아키텍처, 언어)에 대한 모든 리소스를 포함합니다. 이로 인해 사용자의 기기와 관련 없을 수 있는 리소스까지 포함하게 되어 파일 크기가 커질 수 있습니다.

APK 파일은 기기에 직접 설치되며, 공식 앱 스토어 외부에서 공유하거나 **사이드로드(sideloaded)** 할 수 있습니다. 그러나 다양한 기기에 대한 구성을 관리하는 것은 개발자의 책임이며, APK는 종종 특정 기기에는 불필요한 리소스를 포함하게 됩니다.

### AAB (Android App Bundle, 안드로이드 앱 번들)

Google에 의해 도입된 AAB 형식은 APK와 같은 설치 가능 형식이 아닌 **게시 형식(publishing format)** 입니다. 개발자는 AAB를 Google Play에 업로드하면, Google Play는 이를 처리하여 개별 기기에 맞춰 최적화된 APK를 생성합니다.

AAB 파일은 **모듈식(modular)** 이며, 다양한 구성에 대한 리소스와 코드를 별개의 번들로 분리합니다. Google Play는 이 모듈식 구조를 사용하여 다운로드 시점에 기기별 APK를 생성합니다. 예를 들어, 특정 화면 크기, CPU 아키텍처, 언어에 필요한 리소스와 코드만 전달하여 사용자의 기기에서 앱 크기를 줄입니다.

AAB 파일은 서버 측에서 처리되기 때문에 직접 설치할 수 없습니다. 개발자는 `bundletool` 유틸리티와 같은 추가 도구 없이는 AAB 파일을 사용자에게 직접 배포하여 사이드로드하도록 할 수 없습니다.

### APK와 AAB의 주요 차이점

* **목적 및 구조**
    * **APK:** 모든 구성에 대한 모든 리소스와 코드를 포함하는 완전한 패키지입니다.
    * **AAB:** 기기별 최적화된 APK를 생성하는 모듈식 게시 형식입니다.

* **파일 크기**
    * **APK:** 모든 기기에 대한 리소스를 포함하여 크기가 더 큽니다.
    * **AAB:** 더 작고 최적화된 APK 생성을 가능하게 하여 사용자에게 전달되는 앱의 크기를 줄입니다.

* **배포**
    * **APK:** 기기에 직접 공유하고 사이드로드할 수 있습니다.
    * **AAB:** Google Play에 업로드하면, Google Play가 최종 사용자를 위한 최적화된 APK를 생성합니다.

* **관리**
    * **APK:** 개발자가 리소스와 구성을 수동으로 관리해야 합니다.
    * **AAB:** 구성 관리를 Google Play에 위임하여 프로세스를 자동화합니다.

* **도구 및 호환성**
    * **APK:** 모든 안드로이드 기기 및 앱 스토어에서 지원됩니다.
    * **AAB:** 설치 가능한 APK를 만들려면 Google Play 또는 `bundletool`이 필요하며, 기본적으로 Google 이외의 앱 스토어와는 호환되지 않습니다.

### 요약

APK 파일은 독립적이고 직접 설치 가능하지만, AAB 파일은 현대적인 배포 방식을 위해 설계되어 더 작고 기기별로 최적화된 APK를 가능하게 합니다. 개발자는 AAB를 통해 앱 크기 감소 및 자동화된 구성 관리의 이점을 얻을 수 있으며, APK는 사이드로딩 및 Google Play 이외의 배포에 여전히 필수적입니다. 이러한 차이점을 이해하면 개발자는 앱의 배포 전략에 따라 올바른 형식을 선택할 수 있습니다.

---

## Q. AAB 형식은 다양한 기기 구성에 대해 앱 전달을 어떻게 최적화하며, 이것이 전통적인 APK 배포 방식에 비해 어떤 장점을 제공하나요?

**AAB(Android App Bundle)** 형식은 다양한 기기 구성에 맞춰 앱을 효율적으로 전달하도록 설계되었으며, 전통적인 **APK(Android Package)** 배포 방식에 비해 여러 중요한 장점을 제공합니다.

### 1. AAB 형식의 앱 전달 최적화 방식

AAB는 사용자가 앱을 설치할 때 Google Play 스토어가 각 사용자의 기기 구성에 맞는 최적화된 APK를 생성하여 제공할 수 있도록 하는 **게시(publishing) 형식**입니다. 최적화는 주로 다음 메커니즘을 통해 이루어집니다.

1.  **모듈식 구조 (Modular Structure):**
    * AAB는 앱의 모든 코드와 리소스를 포함하지만, 이를 다양한 구성에 따라 분리된 모듈 또는 "분할(splits)"된 형태로 구성합니다.
    * **기본 모듈 (Base Module):** 모든 기기에 공통적으로 필요한 핵심 코드와 리소스를 포함합니다.
    * **구성 분할 (Configuration Splits):**
        * **화면 밀도 (Screen Density):** `mdpi`, `hdpi`, `xhdpi`, `xxhdpi` 등 다양한 화면 밀도에 맞는 이미지 리소스(drawable) 세트를 분리합니다.
        * **CPU 아키텍처 (ABI - Application Binary Interface):** `armeabi-v7a`, `arm64-v8a`, `x86`, `x86_64` 등 각기 다른 CPU 아키텍처를 위한 네이티브 라이브러리를 분리합니다.
        * **언어 (Language):** `values-ko`, `values-en` 등 다양한 언어별 문자열 리소스(string resources)를 분리합니다.

2.  **Google Play의 서버 측 처리 (Dynamic Delivery):**
    * 개발자가 AAB 파일을 Google Play에 업로드하면, Google Play는 이 AAB를 저장하고 있습니다.
    * 사용자가 앱을 다운로드하려고 하면, Google Play는 해당 사용자의 **기기 구성** (화면 밀도, CPU 아키텍처, 설정된 언어 등)을 확인합니다.
    * 이 정보를 바탕으로 Google Play는 AAB 내의 모듈 중에서 해당 기기에 **필요한 기본 모듈과 특정 구성 분할만을 조합**하여 **맞춤형 APK를 즉석에서 생성**하여 사용자에게 전달합니다.
    * 예를 들어, `xhdpi` 화면, `arm64-v8a` CPU, 한국어를 사용하는 기기에는 해당 밀도의 이미지, 해당 ABI의 라이브러리, 한국어 리소스(및 기본 리소스)만 포함된 APK가 제공됩니다. 다른 밀도, ABI, 언어의 리소스는 포함되지 않습니다.

3.  **다이내믹 기능 모듈 (Dynamic Feature Modules - 선택적):**
    * AAB는 앱의 특정 기능을 별도의 모듈로 분리하여, 사용자가 해당 기능을 실제로 사용하려고 할 때만 다운로드하여 설치하도록 할 수 있습니다. 이는 초기 설치 크기를 더욱 줄이는 데 기여합니다.

4.  **애셋 팩 (Asset Packs - 주로 게임용):**
    * 대용량 게임 애셋(텍스처, 사운드 등)을 앱 번들과 별도로 패키징하여 필요에 따라 또는 설치 시점에 동적으로 전달할 수 있습니다.

### 2. 전통적인 APK 배포 방식 대비 AAB의 장점

AAB를 사용한 최적화된 앱 전달 방식은 전통적인 단일 "통합(fat)" APK 배포 방식에 비해 다음과 같은 주요 장점을 제공합니다.

1.  **앱 크기 대폭 감소:**
    * **가장 큰 장점**입니다. 사용자는 자신의 기기에 필요한 코드와 리소스만 다운로드받으므로, 앱의 실제 다운로드 크기와 설치 후 기기에서 차지하는 저장 공간이 크게 줄어듭니다. (Google에 따르면 평균 20% 크기 절감 효과)
    * APK 방식에서는 모든 기기 구성을 위한 리소스가 포함되어 있어 사용자 기기에는 불필요한 데이터가 많았습니다.

2.  **설치율 증가 및 제거율 감소:**
    * 앱 크기가 작아지면 다운로드 시간이 단축되어 사용자가 설치를 완료할 가능성이 높아집니다 (특히 느린 네트워크 환경이나 데이터 요금에 민감한 지역).
    * 기기 저장 공간에 대한 부담이 줄어들어, 저장 공간 부족으로 인한 앱 제거율을 낮추는 데 도움이 될 수 있습니다.

3.  **개발자 빌드 관리 단순화:**
    * 과거 APK 방식에서는 다양한 기기 구성을 지원하기 위해 개발자가 직접 여러 버전의 APK(예: ABI별, 밀도별 분할 APK)를 생성하고, 각기 다른 버전 코드로 관리하며 Google Play에 업로드해야 했습니다. 이는 복잡하고 오류 발생 가능성이 높았습니다.
    * AAB 방식에서는 개발자는 **단일 AAB 파일만 빌드하고 업로드**하면, Google Play가 나머지 최적화된 APK 생성 및 제공 과정을 자동으로 처리해 주므로 출시 프로세스가 매우 간소화됩니다.

4.  **다이내믹 기능 제공 (Dynamic Feature Delivery):**
    * 사용자가 특정 기능을 원할 때만 해당 기능을 다운로드하도록 하여, 초기 설치 크기를 최소화하면서도 풍부한 기능을 제공할 수 있습니다.

5.  **애셋 제공 (Play Asset Delivery):**
    * 특히 대용량 게임의 경우, 고품질 애셋을 필요에 따라 동적으로 전달하여 초기 다운로드 부담을 줄이고 사용자 경험을 개선할 수 있습니다.

6.  **미래 기기 구성에 대한 유연성 향상:**
    * 새로운 화면 밀도나 CPU 아키텍처가 등장하더라도, 개발자가 매번 모든 APK 변형을 다시 빌드하고 업로드할 필요 없이 Google Play가 기존 AAB에서 새로운 구성에 맞는 APK를 생성할 수 있습니다.

7.  **Google Play 필수 요건:**
    * 2021년 8월부터 Google Play에 새로 앱을 출시하거나, 2021년 11월부터 기존 앱을 업데이트할 때 AAB 형식 사용이 의무화되었습니다. 이를 통해 안드로이드 생태계 전반의 앱 크기 최적화 및 사용자 경험 향상을 도모하고 있습니다.

결론적으로 AAB는 Google Play를 통해 앱을 배포하는 현대적인 방식으로, 사용자에게는 더 작고 최적화된 앱을 제공하며 개발자에게는 빌드 및 출시 관리를 단순화하는 중요한 이점을 제공합니다.