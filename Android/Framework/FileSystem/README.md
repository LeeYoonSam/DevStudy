# 안드로이드 파일 시스템이란 무엇인가요?

안드로이드 파일 시스템은 안드로이드 기기에서 **데이터 저장소를 관리하고 구성하는 구조화된 환경**입니다. 이를 통해 애플리케이션과 사용자는 파일을 효율적으로 저장, 검색 및 관리할 수 있습니다. 이 파일 시스템은 리눅스의 파일 시스템 아키텍처를 기반으로 구축되었으며, 엄격한 보안 및 권한 모델을 준수하면서 애플리케이션을 위한 **비공개 및 공유 저장 공간**을 모두 제공합니다.

### 안드로이드 파일 시스템의 주요 구성 요소

안드로이드 파일 시스템은 각각 고유한 목적을 가진 다양한 디렉터리와 파티션으로 구성됩니다.

* **시스템 파티션 (`/system`):**
    안드로이드 프레임워크 라이브러리, 시스템 앱, 설정 파일을 포함한 핵심 운영체제 파일을 담고 있습니다. 이 파티션은 일반 사용자 및 앱이 실수로 또는 악의적으로 수정하는 것을 방지하기 위해 **읽기 전용**입니다.

* **데이터 파티션 (`/data`):**
    데이터베이스, 공유 환경설정(SharedPreferences), 사용자 생성 파일 등 **앱별 데이터**를 저장합니다. 각 앱은 `/data/data/<패키지_이름>` 내에 자신만의 비공개 디렉터리를 가지며, 이 디렉터리는 해당 앱만 접근할 수 있어 데이터 보안을 보장합니다.

* **캐시 파티션 (`/cache`):**
    시스템 업데이트나 기기 재시작 후에도 유지될 필요가 없는 캐시된 파일과 같은 **임시 데이터 저장소**로 사용됩니다.

* **외부 저장소 (`/sdcard` 또는 `/storage`):**
    여러 앱이 접근할 수 있는 **공유 저장 공간**을 제공하며, 주로 이미지, 동영상, 문서와 같은 미디어 파일을 저장하는 데 사용됩니다. 이는 내장 메모리의 일부이거나 이동식 SD 카드일 수 있습니다.

* **임시 파일 (`/tmp`):**
    앱 실행 중 **임시 파일을 저장**하는 위치입니다. 이러한 파일은 일반적으로 앱이나 시스템이 재시작될 때 삭제됩니다.

### 안드로이드에서 파일 접근하기

애플리케이션은 안드로이드 프레임워크에서 제공하는 API를 사용하여 파일 시스템과 상호작용합니다. 필요한 파일 가시성 및 수명에 따라 앱은 파일을 다른 위치에 저장할 수 있습니다.

* **내부 저장소 (Internal Storage):**
    애플리케이션 샌드박스 내의 비공개 저장 공간으로, 해당 앱만 접근할 수 있습니다. 민감하거나 앱 특정 데이터를 저장하는 데 이상적입니다.

* **외부 저장소 (External Storage):**
    여러 앱이 접근할 수 있는 공유 저장 공간으로, 사용자가 앱 외부에서도 접근할 것으로 예상하는 사용자 생성 콘텐츠나 미디어에 사용됩니다.

### 파일 권한 및 보안

안드로이드 파일 시스템은 엄격한 권한 모델을 시행합니다.

* **비공개 앱 데이터:** 앱의 내부 저장소에 저장된 파일은 비공개이며 해당 앱만 접근할 수 있습니다.
* **공유 파일:** 앱 간에 파일을 공유하려면 개발자는 외부 저장소를 사용하거나 적절한 권한을 가진 콘텐츠 제공자(Content Provider)를 사용할 수 있습니다.
* **범위 지정 저장소 (Scoped Storage):** 안드로이드 10에서 도입되었으며, 공유 저장소에 대한 직접적인 접근을 제한하고 앱이 MediaStore 또는 SAF(Storage Access Framework, 저장소 접근 프레임워크) API를 사용하도록 요구합니다.

### 요약

안드로이드 파일 시스템은 애플리케이션과 사용자를 위한 데이터 저장소를 구성하고 관리하는 견고하고 안전한 환경입니다. 시스템 파일, 앱별 데이터 및 공유 콘텐츠를 위한 전용 공간을 제공하는 동시에 엄격한 보안 및 권한 제어를 준수합니다. 개발자는 다양한 API를 통해 이 시스템과 상호작용하여 앱의 필요에 맞는 효율적이고 안전한 파일 관리를 구현할 수 있습니다.

---

## Q. 안드로이드는 파일 시스템에서 보안 및 권한을 어떻게 시행하며, 앱이 서로의 비공개 데이터에 접근할 수 없도록 보장하는 메커니즘은 무엇인가요?

안드로이드는 강력한 보안 모델을 기반으로 파일 시스템의 안전성을 확보하고, 각 앱이 서로의 비공개 데이터에 함부로 접근할 수 없도록 다양한 메커니즘을 시행하고 있습니다. 주요 방식은 다음과 같습니다.

### 1. 애플리케이션 샌드박싱 (Application Sandboxing) - 핵심 원칙

* **고유 사용자 ID (UID) 할당:** 안드로이드 시스템은 각 앱이 설치될 때마다 리눅스 커널 수준에서 고유한 사용자 ID(UID)와 그룹 ID(GID)를 할당합니다.
* **프로세스 격리:** 각 앱은 자신만의 UID로 자신만의 프로세스에서 실행됩니다. 이를 통해 한 앱의 프로세스가 다른 앱의 프로세스 메모리에 직접 접근하는 것이 원천적으로 차단됩니다.
* **리눅스 기반 파일 시스템 권한:** 안드로이드는 리눅스 커널을 기반으로 하므로, 파일 및 디렉터리에 대한 접근 권한 역시 리눅스의 사용자 및 그룹 기반 권한 모델을 따릅니다.
    * 각 앱의 비공개 데이터 디렉터리(일반적으로 `/data/data/<패키지_이름>/`)는 해당 앱의 UID로 소유권이 설정됩니다.
    * 표준 리눅스 파일 권한(읽기, 쓰기, 실행 권한에 대한 소유자/그룹/기타 사용자 설정)이 적용되어, 오직 해당 앱(자신의 UID로 실행 중인)만이 자신의 비공개 데이터 디렉터리에 접근(읽기/쓰기)할 수 있습니다. 다른 UID를 가진 앱은 커널 수준에서 접근이 거부됩니다.

### 2. 매니페스트 선언 권한 및 런타임 권한

* **`<uses-permission>` 선언:** 앱이 자신의 샌드박스 외부의 리소스나 기능(예: 카메라, 위치 정보, 연락처, 외부 저장소 접근 등)을 사용하려면, 반드시 `AndroidManifest.xml` 파일에 `<uses-permission>` 태그를 사용하여 해당 권한을 선언해야 합니다.
* **런타임 권한 (Android 6.0, API 레벨 23 이상):** "위험 권한"(사용자 개인 정보나 기기 작동에 영향을 미칠 수 있는 권한)으로 분류된 권한들은 매니페스트 선언 외에도, 앱 실행 중에 사용자에게 명시적으로 동의를 구해야 합니다. 사용자는 이 요청을 승인하거나 거부할 수 있으며, 이를 통해 앱이 접근할 수 있는 공유 리소스를 사용자가 직접 제어합니다.

### 3. 내부 저장소 격리 강화

* 앱의 내부 저장소 내 특정 디렉터리들(예: `/data/data/<패키지_이름>/files/`, `/data/data/<패키지_이름>/databases/`, `/data/data/<패키지_이름>/shared_prefs/` 등)은 앱 설치 시 자동으로 생성되며, 파일 시스템 권한 설정을 통해 오직 해당 앱의 UID만이 접근할 수 있도록 엄격하게 격리됩니다. 이것이 바로 한 앱이 다른 앱의 내부 데이터를 직접 읽거나 수정할 수 없는 주된 이유입니다.

### 4. 외부 저장소 권한 및 범위 지정 저장소 (Scoped Storage)

* **과거 외부 저장소 권한:** 이전 안드로이드 버전에서는 `READ_EXTERNAL_STORAGE` 및 `WRITE_EXTERNAL_STORAGE` 권한이 외부 저장소 전체에 대한 광범위한 접근을 허용하여, 사용자가 개인적인 파일을 저장했을 경우 보안에 취약점이 될 수 있었습니다.
* **범위 지정 저장소 (Android 10, API 레벨 29 이상):** 이 모델은 외부 저장소의 개인 정보 보호를 크게 강화했습니다.
    * **앱별 외부 저장소 디렉터리:** 앱은 별도의 권한 없이 자신의 외부 저장소 내 앱별 디렉터리(`Android/data/<패키지_이름>/` 또는 `Android/media/<패키지_이름>/`)에 자유롭게 파일을 저장하고 접근할 수 있습니다. 이 공간은 앱 제거 시 함께 삭제됩니다.
    * **공유 미디어 접근:** 다른 앱이 생성한 공유 미디어 파일(사진, 동영상, 오디오 파일 등 공용 컬렉션에 저장된)에 접근하려면, `MediaStore` API를 사용해야 하며 일반적으로 해당 미디어 유형에 대한 권한(예: `READ_MEDIA_IMAGES`, `READ_MEDIA_VIDEO`)이 필요합니다.
    * **기타 파일 접근 (문서 등):** 다른 앱이 생성한 문서나 다운로드 파일 등에 접근하려면 저장소 접근 프레임워크(Storage Access Framework, SAF)를 사용해야 합니다. 이는 시스템 파일 선택기 UI를 통해 사용자가 명시적으로 특정 파일이나 디렉터리에 대한 접근을 허용하는 방식입니다.
    * **직접 경로 접근 제한:** 대부분의 앱은 임의의 외부 저장소 경로에 대한 직접적인 파일 경로 접근이 크게 제한됩니다.

### 5. 콘텐츠 제공자 (Content Provider)를 통한 제어된 데이터 공유

* 앱이 자신의 데이터를 다른 앱과 **선택적이고 제어된 방식**으로 공유하고자 할 때 `ContentProvider`를 구현할 수 있습니다.
* 콘텐츠 제공자는 앱 데이터(예: 데이터베이스) 위에 추상화 계층을 제공하며, 다른 앱은 `ContentResolver`를 통해 특정 URI(Uniform Resource Identifier)를 사용하여 데이터에 접근합니다.
* 콘텐츠 제공자는 자체적인 읽기/쓰기 권한을 정의하고 매니페스트에 선언하여, 다른 앱이 해당 데이터를 사용하기 전에 이 권한을 요청하고 부여받도록 강제할 수 있습니다. 이를 통해 어떤 데이터를 누구와 어떻게 공유할지 세밀하게 제어할 수 있습니다.

### 6. 기타 보안 메커니즘

* **프로세스 간 통신(IPC) 메커니즘:** 인텐트(Intent), 서비스 바인딩(AIDL 사용), 메신저(Messenger) 등 안드로이드가 제공하는 구조화된 IPC 방법들도 자체적인 권한 검사나 매니페스트에 정의된 컴포넌트 가시성(`exported` 속성 등)에 의존하여 보안을 유지합니다.
* **SELinux (Security-Enhanced Linux):** 안드로이드는 SELinux를 강제 모드(enforcing mode)로 사용하여 MAC(Mandatory Access Control, 강제적 접근 제어)을 구현합니다. SELinux는 기존의 리눅스 DAC(Discretionary Access Control, 임의적 접근 제어) 권한 외에 추가적인 보안 계층을 제공하여, 프로세스(앱 포함)가 할 수 있는 일을 더욱 엄격하게 제한합니다.

이러한 다층적인 보안 메커니즘과 권한 모델을 통해 안드로이드는 각 앱의 데이터를 서로 격리시키고, 사용자의 개인 정보를 보호하며, 시스템 전체의 안정성을 강화합니다.